{% extends 'base.html' %}

{% block content %}

<br>

<!-- CAMPO DE BÚSQUEDA -->
<input id="searchInput" type="text" class="form-control mb-3" placeholder="Buscar...">

<div class="table-scroll">
<table id="dataTable" class="table table-striped table-hover table-bordered">
    <thead>
        <tr>
            <th>Cod DUN</th>
            <th>Cod EAN</th>
            <th>Cod Sistema</th>
            <th>Descripción</th>
            <th>Cajas Bsf</th>
            <th>Cajas Central</th>
            <th>Stock Bsf</th>
            <th>Stock Central</th>
            <th>Total Cajas Lingues + Bsf</th>
        </tr>
    </thead>

    <tbody>
        {% for item in resumen %}
        <tr>
            <td>{{ item.cod_dun }}</td>
            <td>{{ item.cod_ean }}</td>
            <td>{{ item.cod_sistema }}</td>
            <td>{{ item.descripcion }}</td>
            <td>{{ item.cajas_bsf }}</td>
            <td>{{ item.cajas_central }}</td>
            <td>{{ item.stock_bsf }}</td>
            <td>{{ item.stock_central }}</td>
            <td>{{ item.total_cajas }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>

<!-- SCRIPT DEL FILTRO -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const input = document.getElementById("searchInput");
    const table = document.getElementById("dataTable");
    const rows = table.getElementsByTagName("tr");

    input.addEventListener("keyup", function () {
        const filter = input.value.toLowerCase();

        for (let i = 1; i < rows.length; i++) {
            const cells = rows[i].getElementsByTagName("td");
            let found = false;

            for (let j = 0; j < cells.length; j++) {
                const text = cells[j].textContent.toLowerCase();
                if (text.indexOf(filter) > -1) {
                    found = true;
                    break;
                }
            }

            rows[i].style.display = found ? "" : "none";
        }
    });
});
</script>

{% endblock %}
